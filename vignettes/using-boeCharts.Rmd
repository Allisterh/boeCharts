---
title: "Using boeCharts"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Using boeCharts}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 7, fig.height = 4, cache=FALSE, dev = 'svg', fig.dpi = 96
)

```

The `boeCharts` package provides tools to help build and productionise charts with `ggplot2` that are suitable for use around the Bank. This includes base themes for publications, recognised colour palettes, and helpful 'last-mile' utilities (detailed in ['Last-mile' formatting](last-mile-formatting.html)) for things like formatting date labels.

## Colour palettes

To get Bank palettes in your plots, use `scale_colour_boe` and `scale_fill_boe` as part of a standard `ggplot2` workflow. Both of these functions contain a `palette` argument, which should be set to your palette of choice. You can see the options available by calling `boe_palettes`.

```{r}
# load package
library(boeCharts)

boe_palettes
```

You can preview the colours in a palette with `show_palette_cols` (notice that each palette is available in a vector, too).

```{r}
show_palette_cols(x = boe_cols_rich)
```

#### Bank-wide palettes

Apply colour schemes lifted from [Bank visual identity guidelines](http://intranet/BankNews/Pages/Updated-visual-identity-g-636195499604295252.aspx), like those seen in the [website's statistics section](https://www.bankofengland.co.uk/statistics/visual-summaries/effective-interest-rates). Here's the "boe" palette.

```{r boe_pal}
# load package
library(ggplot2)

# make a plot
p <- ggplot(data = FANG, aes(x = date, y = close, colour = symbol)) +
  geom_line() +
  labs(title = "BoE palette & theme test",
       subtitle="A plot for demonstration purposes",
       y="Closing\nprice", x=NULL) +
  theme_minimal()

p +
  # apply boe palette
  scale_colour_boe(palette = "boe")

```

#### Business area / publication-ready palettes

Use colour schemes for your own business area or publications. For example, use colours seen in [historic Money & Credit statistical releases](https://www.bankofengland.co.uk/-/media/boe/files/statistics/money-and-credit/2017/october-2017.pdf?la=en&hash=F91456AC176039665F053EEE634CC2DB6D2DA506) with the "mcg" palette.

```{r mcg_pal}

p +
  # apply mcg palette
  scale_colour_boe(palette = "mcg")

```


## Chart themes

Go beyond palettes, and control the appearance of all (non-data) chart elements with **themes** to produce Bank-style plots.

### Inflation Report

A theme that approximates the design of charts in [the Inflation Report](https://www.bankofengland.co.uk/inflation-report/2018/august-2018/the-labour-market-and-pay). Note the arguments passed to `scale_y_continuous()` to achieve the correct y-axis format (as well as `scale_colour_boe`, seen earlier, to do the colours).

```{r ir_theme}

p +
  # apply boe palette
  scale_colour_boe(palette = "boe") +
  # add MCG theme
  theme_inflation_report() +
  # axis settings
  scale_y_continuous(position = "right", expand = c(0, 0), limits = c(0, 1250), breaks = seq(0, 1250, 250))
```

### DSD Publications

### Money & Credit

A theme that approximates the design of charts in [Money & Credit statistical releases](https://www.bankofengland.co.uk/statistics/money-and-credit/2018/may-2018) is found in `theme_mcg_pub()`.

```{r mcg_theme}

p +
  # apply boe palette
  scale_colour_boe(palette = "boe") +
  # add MCG theme
  theme_mcg_pub() +
  # axis settings
  scale_y_continuous(position = "right", expand = c(0, 0), limits = c(0, 1250), breaks = seq(0, 1250, 250)) +
  scale_x_date(expand = c(0, 0), breaks = seq(min(FANG$date), max(FANG$date), by = "3 months"), labels = boe_date_labels())
```
